# Generated by Anaconda 34.25.5.9
# Generated by pykickstart v3.32
#version=RHEL9
# Use graphical install
graphical
# Reboot after installation
reboot

%post
# Create /data mount point and mount

#Install ansible-core
dnf install -y ansible-core

# Set KDE Plasma as default GUI
systemctl set-default graphical.target

# Add Docker repository
cat <<EOF > /etc/yum.repos.d/docker.repo
[docker-ce-stable]
name=Docker CE Stable - \$basearch
baseurl=https://download.docker.com/linux/centos/\$releasever/\$basearch/stable
enabled=1
gpgcheck=1
gpgkey=https://download.docker.com/linux/centos/gpg
EOF

# Install Docker
dnf install -y docker-ce docker-ce-cli containerd.io

# Create cap_ansadmin user
echo "captcrunch ALL=(ALL) NOPASSWD: ALL" | tee /etc/sudoers.d/captcrunch
%end

%addon com_redhat_kdump --enable --reserve-mb='auto'

%end

# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'
# System language
lang en_CA.UTF-8

# Firewall configuration
firewall --disabled
# Network information
network  --hostname=cappy1.local

%packages
@^graphical-server-environment
@dns-server
@file-server
@network-file-system-client
@remote-desktop-clients
@remote-system-management
@smb-server
@system-tools

%end

# SELinux configuration
selinux --disabled

firstboot --disable

# Generated using Blivet version 3.6.0
ignoredisk --only-use=nvme0n1
# Partition clearing information
clearpart --all --initlabel
# Disk partitioning information
part / --fstype="xfs" --ondisk=nvme0n1 --size=242573
part /boot/efi --fstype="efi" --ondisk=nvme0n1 --size=600 --fsoptions="defaults,uid=0,gid=0,umask=077,shortname=winnt"
part /boot --fstype="xfs" --ondisk=nvme0n1 --size=1024

# Intended system purpose
syspurpose --role="Red Hat Enterprise Linux Server" --sla="Self-Support" --usage="Development/Test"

# System timezone
timezone America/Toronto --utc

# Root password
rootpw --plaintext 11094eA1
user --groups=wheel --name=captcrunch --password=122
